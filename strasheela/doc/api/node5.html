<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
 <head>
  <title>MUtils</title>
  <style>BODY {
 background: url(page.gif) repeat-y white;
}
#slidemenubar, #slidemenubar2{
 position:absolute;
 left:-144px;
 width:160px;
 top:10px;
 border:0px solid black;
 font:bold 12px Verdana;
 line-height:10px;
}
.margin {
 position: absolute;
 left: 10px;
 width: 130px;
}
BODY, P, H1, H2, H3, A {
 font-family: sans-serif;
}
PRE, CODE {
 font-family: courier, monospace;
}
P {
 text-align: justify;
}
H1     { color: #9B0000; }
H2     { color: #FF9933; }
H3, H4 { color: #881155; }
CODE              { color: #663366; }
.code CODE        { color: #000000; }
SPAN.comment      { color: #B22222; }
SPAN.keyword      { color: #A020F0; }
SPAN.string       { color: #BC8F8F; }
SPAN.functionname { color: #0000FF; }
SPAN.type         { color: #228B22; }
SPAN.variablename { color: #B8860B; }
SPAN.reference    { color: #5F9EA0; }
SPAN.builtin      { color: #DA70D6; }
A:link {
 color: #666666;
}
A:visited {
 color: black;
}
A.pre { font-family: courier, monospace;
 color: #228B22;
}
</style>
 </head>
<body>
<script language="JavaScript1.2">
if (document.all)
document.write('<div id="slidemenubar2" style="left:-144" onMouseover="pull()" onMouseout="draw()">')
</script>
<layer id="slidemenubar" onMouseover="pull()" onMouseout="draw()">
<table border="0" cellpadding="0" cellspacing="0" width="161"><tr><td bgcolor="#009cff" width="144"><a href="index.html">Index</a>
</td><td rowspan="13" valign="top" width="16"><img src="menu.gif" width="16"></td></tr><tr><td bgcolor="#009cff" width="144"><a href="node1.html">Strasheela</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node2.html">Init</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node3.html">GUtils</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node4.html">LUtils</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node5.html">MUtils</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node6.html">Score</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node7.html">SMapping</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node8.html">SDistro</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node9.html">Out</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node10.html">Strasheela</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node11.html">FD_edited</a>
</td></tr><tr><td bgcolor="#009cff" width="144"><a href="node12.html">Midi</a>
</td></tr></table></layer>
<script language="JavaScript1.2">
function regenerate(){
window.location.reload()
}
function regenerate2(){
if (document.layers)
setTimeout("window.onresize=regenerate",400)
}
window.onload=regenerate2
if (document.all){
document.write('</div>')
themenu=document.all.slidemenubar2.style
rightboundary=0
leftboundary=-144
}
else{
themenu=document.layers.slidemenubar
rightboundary=144
leftboundary=0
}
function pull(){
if (window.drawit)
clearInterval(drawit)
pullit=setInterval("pullengine()",20)
}
function draw(){
clearInterval(pullit)
drawit=setInterval("drawengine()",50)
}
function pullengine(){
if (document.all&&themenu.pixelLeft<rightboundary)
themenu.pixelLeft+=5
else if(document.layers&&themenu.left<rightboundary)
themenu.left+=5
else if (window.pullit)
clearInterval(pullit)
}
function drawengine(){
if (document.all&&themenu.pixelLeft>leftboundary)
themenu.pixelLeft-=5
else if(document.layers&&themenu.left>leftboundary)
themenu.left-=5
else if (window.drawit)
clearInterval(drawit)
}
</script>

<div style="margin-left:160px"><span class="string">

<table border="0" cellpadding="2" cellspacing="2"><tr bgcolor="#eeeecc">




</tr></table>
<span class="string"> This functor defines some utilities which are related to music or acoustics.<BR>
<BR>
</span>
</span>
<h3>Functor</h3>
<ul>MUtils ("<span class="string">/Users/torsten/oz/music/Strasheela/strasheela/trunk/strasheela/source/MusicUtils.oz</span>")<br></ul>
<h3>Import</h3>
<code><ul><li>Emacs</li><li><a href="node3.html">GUtils</a> at "<span class="string">GeneralUtils.ozf"
</span></li><li><a href="node4.html">LUtils</a> at "<span class="string">ListUtils.ozf"
</span></li><li><a href="node2.html">Init</a> at "<span class="string">Init.ozf"
</span></li><li><a href="node9.html">Out</a> at "<span class="string">Output.ozf"
</span></li><li>Pattern at "<span class="string">x-ozlib://anders/strasheela/Pattern/Pattern.ozf"
</span></li></ul></code>
<h3>Export</h3>
<code><ul><li>&lt;P/3:<a href="#entity279"><span class="functionname">KeynumToFreq</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity280"><span class="functionname">FreqToKeynum</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity281"><span class="functionname">IsET</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity282"><span class="functionname">GetPitchesPerOctave</span></a>&gt;
</li><li>&lt;P/4:<a href="#entity283"><span class="functionname">PitchToMidi</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity284"><span class="functionname">RatioToKeynumInterval</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity285"><span class="functionname">KeynumToPC</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity286"><span class="functionname">TransposeRatioIntoStandardOctave</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity287"><span class="functionname">RatioToStandardOctaveFloat</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity288"><span class="functionname">SortRatios</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity289"><span class="functionname">SortRatios2</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity290"><span class="functionname">RatioToRatioPC</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity291"><span class="functionname">OddLimit</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity292"><span class="functionname">PrimeLimit</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity293"><span class="functionname">LevelToDB</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity294"><span class="functionname">DBToLevel</span></a>&gt;
</li><li><span class="variablename">Freq0</span>
</li><li>&lt;P/2:<a href="#entity295"><span class="functionname">FullTuningTable</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity296"><span class="functionname">MakeNoteLengthsTable</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity297"><span class="functionname">MakeNoteLengthsRecord</span></a>&gt;
</li><li>&lt;P/3:<a href="#entity298"><span class="functionname">MakeDurationsRecord</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity299"><span class="functionname">SetNoteLengthsRecord</span></a>&gt;
</li><li>&lt;P/1:<a href="#entity300"><span class="functionname">GetNoteLengthsRecord</span></a>&gt;
</li><li>&lt;P/0:<a href="#entity302"><span class="functionname">FeedNoteLengthVariables</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity301"><span class="functionname">ToDur</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity303"><span class="functionname">SetDurationsRecord</span></a>&gt;
</li><li>&lt;P/2:<a href="#entity304"><span class="functionname">ToNoteLengths</span></a>&gt;
</li></ul></code>
<h3>Define</h3>

<code>
<a name="entity279">
<span class="keyword">fun</span>{<span class="functionname">KeynumToFreq</span> Keynum KeysPerOctave}<br>
<span class="string"> Transforms a Keynum into the corresponding frequency in an equally tempered scale with KeysPerOctave keys per octave. The function is 'tuned' such that {KeynumToFreq 69.0 12.0} returns 440.0 Hz. All arguments must be floats and a float is returned.<BR>
 NB: The term Keynum here is not limited to a MIDI keynumber but denotes a keynumber in any equidistant tuning. For instance, if KeysPerOctave=1200.0 then Keynum denotes cent values.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity280">
<span class="keyword">fun</span>{<span class="functionname">FreqToKeynum</span> Freq KeysPerOctave}<br>
<span class="string"> Transforms Freq into the corresponding keynum in an equally tempered scale with KeysPerOctave keys per octave. The function is 'tuned' such that {FreqToKeynum 440.0 12.0} returns 69.0. All arguments must be floats and a float is returned.<BR>
 NB: The term Keynum here is not limited to a MIDI keynumber but denotes a keynumber in any equidistant tuning. For instance, if KeysPerOctave=1200.0 then Keynum denotes cent values.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity281">
<span class="keyword">fun</span>{<span class="functionname">IsET</span> PitchUnit}<br>
<span class="string"> Returns true if PitchUnit is an atom which matches the pattern et<Digit>+ such as et31 or et72.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity282">
<span class="keyword">fun</span>{<span class="functionname">GetPitchesPerOctave</span> EtPitchUnit}<br>
<span class="string"> Returns the pitches per octave expressed by an ET pitch unit, e.g., for et31 it returns 31. <BR>
<BR>
</span>
</code><br>

<code>
<a name="entity283">
<span class="keyword">proc</span>{<span class="functionname">PitchToMidi</span> Pitch PitchUnit Args Result}<br>
<span class="string"> Transforms Pitch (an int) measured in PitchUnit (an atom) into the corresponding "Midi float" (a float), i.e. a Midi number where positions after the decimal point express microtonal pitch deviations (e.g., 60.5 is middle C raised by a quarter tone). Possible pitch units are midi (i.e., 12-TET), midicent/midic, frequency/freq/hz, mHz and and arbitrary equal temperaments (e.g., et31, et72).<BR>
 The transformation takes account a tuning table defined with Init.setTuningTable. Alternatively, a tuning table can be given directly to the optional arg 'table'.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity284">
<span class="keyword">fun</span>{<span class="functionname">RatioToKeynumInterval</span> Ratio KeysPerOctave}<br>
<span class="string"> Transforms Ratio (either a float or a fraction specification in the form <Int>#<Int>) into the corresponding keynumber interval in an equally tempered scale with KeysPerOctave (a float) keys per octave. Returns a float.<BR>
 For example, {RatioToKeynumInteval 1.0 12.0}=0.0 or {RatioToKeynum 1.5 12.0}=7.01955). <BR>
 NB: The term Keynum here is not limited to a MIDI keynumber but denotes a keynumber in any equidistant tuning. For instance, if KeysPerOctave=1200.0 then Keynum denotes cent values.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity285">
<span class="keyword">fun</span>{<span class="functionname">KeynumToPC</span> Keynum PitchesPerOctave}<br>
<span class="string"> Variant of RatioToKeynumInterval which directly outputs a cent value (a float).<BR>
 */<BR>
    fun {RatioToCent Ratio} {RatioToKeynumInterval Ratio 1200.0} end<BR>
<BR>
/** %% Transforms a keynumber (a float) in an equally tempered scale with KeysPerOctave (a float) into its corresponding pitch class (a float) in [0, PitchesPerOctave).<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity286">
<span class="keyword">fun</span>{<span class="functionname">TransposeRatioIntoStandardOctave</span> Freq}<br>
<span class="string"> Expects a frequency ratio (a float) and octave transposes it into interval [1.0, 2.0]<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity287">
<span class="keyword">fun</span>{<span class="functionname">RatioToStandardOctaveFloat</span> Ratio}<br>
<span class="string"> Expects a ratio (pair of ints Nom#Denom) and returns the corresponding float, octave transposed into interval [1.0, 2.0].<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity288">
<span class="keyword">fun</span>{<span class="functionname">SortRatios</span> Ratios}<br>
<span class="string"> Expects a list of ratios and sorts them in ascending order (assuming all are situated in the same octave). For example, {SortRatios [4#1 5#1 6#1 7#1 9#1 11#1]} returns [4#1 9#1 5#1 11#1 6#1 7#1].<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity289">
<span class="keyword">fun</span>{<span class="functionname">SortRatios2</span> Ratios StartRatio}<br>
<span class="string"> Expects a list of ratios and sorts them in ascending order (assuming all are situated in the same octave). However, the first ratio in the result is StartRatio (which must occur in Ratios), and all smaller ratios are appended at the end. For example, {SortRatios2 [1#3 1#4 1#5 1#7] 1#7} returns [1#7 1#3 1#5 1#4].<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity290">
<span class="keyword">fun</span>{<span class="functionname">RatioToRatioPC</span> Nom#Denom}
</code><br>

<code>
<a name="entity291">
<span class="keyword">fun</span>{<span class="functionname">OddLimit</span> Ratio}<br>
<span class="string"> Returns the odd limit of Ratio (pair of ints).<BR>
 Restriction: ratio is in lowest terms.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity292">
<span class="keyword">fun</span>{<span class="functionname">PrimeLimit</span> Nom#Denom}<br>
<span class="string"> Returns the prime limit of Ratio (pair of ints).<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity293">
<span class="keyword">fun</span>{<span class="functionname">LevelToDB</span> L LRel}<br>
<span class="string"> Converts a linear amplitude level L into an logarithmic amplitude (decibels).  LRel is the relativ full level.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity294">
<span class="keyword">fun</span>{<span class="functionname">DBToLevel</span> DB LRel}<br>
<span class="string">  Converts a logarithmic amplitude DB (decibels) into a linear amplitude level.  LRel is the relativ full level.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity295">
<span class="keyword">fun</span>{<span class="functionname">FullTuningTable</span> TuningTable}<br>
<span class="string"> Expects a tuning table declaration (see Init.setTuningTable for format) and returns a full tuning table used for pitch computation. The returned full table is a record which contains only pitches measured in cent, has 0.0 added as first table value, and has the two features size and period added.   <BR>
<BR>
</span>
</code><br>

<code>
<a name="entity296">
<span class="keyword">fun</span>{<span class="functionname">MakeNoteLengthsTable</span> Beat TupletFractions}<br>
<span class="string"> MakeNoteLengthsTable creates a list which maps symbolic note lengths to duration values. Expects the duration of a beat (i.e. the timeUnit is beats(Beat)) and a list of tuplet fractions to take into consideration (e.g., [3 5] denotes triplets and quintuplets). The function returns a list of pairs NotationI#DurI. NotationI is denotes a symbolic note length as a virtual string, and DurI is the corresponding duration (an int). <BR>
 Notation of symbolic note lengths:<BR>
 plain durations: 'd' followed by reciprocal values. Example: d#4 is quarter note<BR>
 dotted note lengths: plain duration followed by _ (underscore). Example: d#4#'_' is quarter note + eighth note. Multiple dots are not supported (simply add multiple durations instead).<BR>
 tuplets (notated as individual note lengths): t followed by a number indicating the fraction, followed by the duration. Example: t#3#d#4 is a triplet quarter note and t#3#d#4#'_' is a dotted triplet note. Nested tuplets are not supported.<BR>
 ties: simply add the resulting durations of the individual notes.<BR>
<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity297">
<span class="keyword">fun</span>{<span class="functionname">MakeNoteLengthsRecord</span> Beat TupletFractions}<br>
<span class="string"> Returns a record which maps symbolic note lengths (atoms which are record features) to duration values (integers, feature values in the record). See the documentation of MakeNoteLengthsTable for the arguments Beat and TupletFractions, and also the symbolic note length notation. However, whereas in MakeNoteLengthsTable this notation uses VSs (so it can be easily decomposed) here it uses atoms for convenience.<BR>
<BR>
 Example: create a record R and then use this record for notating symbolic durations.  <BR>
 R = {MakeNoteLengthsRecord 15 [3 5]}<BR>
 R.d4    % quarter note<BR>
 R.t3d4  % quarter note triplet<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity298">
<span class="keyword">fun</span>{<span class="functionname">MakeDurationsRecord</span> Beat TupletFractions}<br>
<span class="string"> Returns a record which maps durations (integers, feature values in the record) to lists of symbolic note lengths (atoms which are record features). See the documentation of MakeNoteLengthsTable for the arguments Beat and TupletFractions, and also the symbolic note length notation.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity299">
<span class="keyword">proc</span>{<span class="functionname">SetNoteLengthsRecord</span> Beat TupletFractions}<br>
<span class="string"> Initialises transformation for ToDur. See the documentation of MakeNoteLengthsTable for the arguments Beat and TupletFractions.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity300">
<span class="keyword">fun</span>{<span class="functionname">GetNoteLengthsRecord</span> }<br>
<span class="string"> Returns the full record of symbolic note lengths atomes (record features) and their associated durations (record values).<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity302">
<span class="keyword">proc</span>{<span class="functionname">FeedNoteLengthVariables</span> }<br>
<span class="string"> Makes all set symbolic note lengths available as variables in the compiler. The variable names are the same as expected, e.g., by ToDur, but all lower-cases are replaced by upper cases. For example, the variable D4 will be bound to the duration of the beat. For all (lower-case) note values see {Arity {MUtils.getNoteLengthsRecord}}.<BR>
 Use SetNoteLengthsRecord for initialisation (default is {SetNoteLengthsRecord 4 nil}).<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity301">
<span class="keyword">fun</span>{<span class="functionname">ToDur</span> NoteLength}<br>
<span class="string"> Expects a symbolic note length (atom) and returns the corresponding duration. Use SetNoteLengthsRecord for initialisation (default is {SetNoteLengthsRecord 4 nil}).<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity303">
<span class="keyword">proc</span>{<span class="functionname">SetDurationsRecord</span> Beat TupletFractions}<br>
<span class="string"> Initialises transformation for ToNoteLengths. See the documentation of MakeNoteLengthsTable for the arguments Beat and TupletFractions.<BR>
<BR>
</span>
</code><br>

<code>
<a name="entity304">
<span class="keyword">fun</span>{<span class="functionname">ToNoteLengths</span> Dur}<br>
<span class="string"> Expects a duration (int) and returns a list of the corresponding symbolic note lengths. Use SetDurationsRecord for initialisation (default is {MakeDurationsRecord 4 nil}).<BR>
<BR>
</span>
</code><br>
<h3>End</h3>
</div></body>
</html>